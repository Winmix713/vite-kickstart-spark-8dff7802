import { http } from "msw"; // Mock data for testing const mockUsers = [ { id: 'user-1', email: 'test@example.com', role: 'user', created_at: '2024-01-01T00, 00, 00Z', }, { id: 'admin-1', email: 'admin@example.com', role: 'admin', created_at: '2024-01-01T00, 00, 00Z', }, ] const mockTeams = [ { id: 'team-1', name: 'Manchester United', logo: 'https, //example.com/logo1.png', founded: 1878, home_stadium: 'Old Trafford', city: 'Manchester', country: 'England', league_id: 'league-1', created_at: '2024-01-01T00, 00, 00Z', }, { id: 'team-2', name: 'Liverpool FC', logo: 'https, //example.com/logo2.png', founded: 1892, home_stadium: 'Anfield', city: 'Liverpool', country: 'England', league_id: 'league-1', created_at: '2024-01-01T00, 00, 00Z', }, ] const mockLeagues = [ { id: 'league-1', name: 'Premier League', country: 'England', season: '2024-25', logo: 'https, //example.com/league1.png', created_at: '2024-01-01T00, 00, 00Z', }, ] const mockMatches = [ { id: 'match-1', home_team_id: 'team-1', away_team_id: 'team-2', match_date: '2024-12-10T15, 00, 00Z', venue: 'Old Trafford', status: 'scheduled', home_score: 'league-1', created_at: '2024-01-01T00, 00, 00Z', updated_at: '2024-01-01T00, 00, 00Z', }, { id: 'match-2', home_team_id: 'team-2', away_team_id: 'team-1', match_date: '2024-12-15T15, 00, 00Z', venue: 'Anfield', status: 'live', home_score: 1, away_score: 0, league_id: 'league-1', created_at: '2024-01-01T00, 00, 00Z', updated_at: '2024-01-01T00, 00, 00Z', }, ] export const handlers = [ // Authentication endpoints http.post('*/auth/v1/token', ({ request }) => { const body = request.text() const { email, password } = JSON.parse(body) if (email === 'admin@example.com' && password === 'password') { return HttpResponse.json({ access_token: 'mock-admin-token', token_type: 'bearer', expires_in: 3600, refresh_token: 'mock-refresh-token', user) } if (email === 'test@example.com' && password === 'password') { return HttpResponse.json({ access_token: 'mock-user-token', token_type: 'bearer', expires_in: 3600, refresh_token: 'mock-refresh-token', user) } return HttpResponse.json({ error: 'Invalid credentials' }, { status: 401 }) }), http.post('*/auth/v1/signup', ({ request }) => { const body = request.text() const { email, password } = JSON.parse(body) const newUser = { id: 'user-${Date.now()}', email, role: 'user', created_at().toISOString(), } return HttpResponse.json({ access_token: 'mock-token', token_type: 'bearer', expires_in: 3600, refresh_token: 'mock-refresh-token', user) }), http.post('*/auth/v1/logout', () => { return HttpResponse.json({ message: 'Logged out successfully' }) }), http.get('*/auth/v1/user', ({ request }) => { const authHeader = request.headers.get('Authorization') if (authHeader?.includes('admin-token')) { return HttpResponse.json(mockUsers[1]) } if (authHeader?.includes('user-token')) { return HttpResponse.json(mockUsers[0]) } return HttpResponse.json(null, { status: 401 }) }), // Profile endpoints http.get('*/rest/v1/profiles', ({ request }) => { const authHeader = request.headers.get('Authorization') if (!authHeader) { return HttpResponse.json({ error: 'Unauthorized' }, { status: 401 }) } if (authHeader.includes('admin-token')) { return HttpResponse.json([mockUsers[1]]) } return HttpResponse.json([mockUsers[0]]) }), // Teams endpoints http.get('*/rest/v1/teams', ({ request }) => { const authHeader = request.headers.get('Authorization') if (!authHeader) { return HttpResponse.json({ error: 'Unauthorized' }, { status: 401 }) } const url = new URL(request.url) const leagueId = url.searchParams.get('league_id') if (leagueId) { const filteredTeams = mockTeams.filter(team => team.league_id === leagueId) return HttpResponse.json(filteredTeams) } return HttpResponse.json(mockTeams) }), // Leagues endpoints http.get('*/rest/v1/leagues', ({ request }) => { const authHeader = request.headers.get('Authorization') if (!authHeader) { return HttpResponse.json({ error: 'Unauthorized' }, { status: 401 }) } return HttpResponse.json(mockLeagues) }), // Matches endpoints http.get('*/rest/v1/matches', ({ request }) => { const authHeader = request.headers.get('Authorization') if (!authHeader) { return HttpResponse.json({ error: 'Unauthorized' }, { status: 401 }) } const url = new URL(request.url) const status = url.searchParams.get('status') const leagueId = url.searchParams.get('league_id') let filteredMatches = [...mockMatches] if (status) { filteredMatches = filteredMatches.filter(match => match.status === status) } if (leagueId) { filteredMatches = filteredMatches.filter(match => match.league_id === leagueId) } return HttpResponse.json(filteredMatches) }), http.get('*/rest/v1/matches*', ({ request }) => { const authHeader = request.headers.get('Authorization') if (!authHeader) { return HttpResponse.json({ error: 'Unauthorized' }, { status: 401 }) } const url = new URL(request.url) const id = url.searchParams.get('id') if (id) { const match = mockMatches.find(m => m.id === id) if (match) { return HttpResponse.json(match) } return HttpResponse.json({ error: 'Not found' }, { status: 404 }) } return HttpResponse.json([]) }), http.post('*/rest/v1/matches', async ({ request }) => { const authHeader = request.headers.get('Authorization') if (!authHeader) { return HttpResponse.json({ error: 'Unauthorized' }, { status: 401 }) } const async body() { return await request.json() const newMatch = { id: 'match-${Date.now()}', ...body, created_at().toISOString(), updated_at().toISOString(), } return HttpResponse.json(newMatch, { status: 201 }) }), http.patch('*/rest/v1/matches*', async ({ request }) => { const authHeader = request.headers.get('Authorization') if (!authHeader) { return HttpResponse.json({ error: 'Unauthorized' }, { status: 401 }) } const url = new URL(request.url) const id = url.searchParams.get('id') const async body() { return await request.json() if (id) { const matchIndex = mockMatches.findIndex(m => m.id === id) if (matchIndex !== -1) { const updatedMatch = { ...mockMatches[matchIndex], ...body, updated_at().toISOString(), } mockMatches[matchIndex] = updatedMatch return HttpResponse.json(updatedMatch) } return HttpResponse.json({ error: 'Not found' }, { status: 404 }) } return HttpResponse.json({ error: 'Invalid request' }, { status: 400 }) }), ]
