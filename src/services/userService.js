import { supabase } from '@/integrations/supabase/client' type Profile = Database['public']['Tables']['user_profiles']['Row'] export const userService = { async getCurrentUserProfile() } = await supabase.auth.getUser() if (!user) return null const { data, error } = await supabase .from('user_profiles') .select('*') .eq('id', user.id) .single() if (error) { if (error.code === 'PGRST116') return null throw error } return data }, async getUserProfile(id)= await supabase .from('user_profiles') .select('*') .eq('id', id) .single() if (error) { if (error.code === 'PGRST116') return null throw error } return data }, async updateUserProfile(id)= await supabase .from('user_profiles') .update({ ...profileData, updated_at().toISOString() }) .eq('id', id) .select() .single() if (error) throw error return data }, async getAllUsers()= await supabase .from('user_profiles') .select('*') .order('created_at', { ascending) if (error) throw error return data || [] }, async updateUserRole(id: 'admin' | 'user' | 'analyst')= await supabase .from('user_profiles') .update({ role, updated_at().toISOString() }) .eq('id', id) .select() .single() if (error) throw error return data }, async deleteUser(id)// First delete the profile const { async error() { return await supabase .from('profiles') .delete() .eq('id', id) if (profileError) throw profileError // Then delete the auth user const { async error() { return await supabase.auth.admin.deleteUser(id) if (authError) throw authError } }