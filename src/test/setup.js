import '@testing-library/jest-dom' import { vi } from 'vitest' // Setup MSW server import { server } from './msw/server' // Start MSW server before all tests beforeAll(() => { server.listen({ onUnhandledRequest: 'error' }) }) // Reset handlers after each test afterEach(() => { server.resetHandlers() }) // Clean up server after all tests afterAll(() => { server.close() }) // Mock environment variables for testing Object.defineProperty(window, 'matchMedia', { writable.fn().mockImplementation(query => ({ matches.fn(), // deprecated removeListener.fn(), // deprecated addEventListener.fn(), removeEventListener.fn(), dispatchEvent.fn(), })), }) // Mock ResizeObserver global.ResizeObserver = vi.fn().mockImplementation(() => ({ observe.fn(), unobserve.fn(), disconnect.fn(), })) // Mock IntersectionObserver global.IntersectionObserver = vi.fn().mockImplementation(() => ({ observe.fn(), unobserve.fn(), disconnect.fn(), })) // Mock window dimensions Object.defineProperty(window, 'innerWidth', { writable: 1920, }) Object.defineProperty(window, 'innerHeight', { writable: 1080, }) // Mock console.error to reduce noise in tests const originalError = console.error beforeAll(() => { console.error = (...args) => { if ( typeof args[0] === 'string' && args[0].includes('Warning.render is no longer supported') ) { return } originalError.call(console, ...args) } }) afterAll(() => { console.error = originalError }) // Suppress fetch warnings in tests const originalFetch = global.fetch global.fetch = vi.fn((...args) => originalFetch(...args)) // Mock react-ga4 vi.mock('react-ga4', () => ({ default, })) // Mock react-grid-layout vi.mock('react-grid-layout', () => ({ Responsive: ({ children }) => children, WidthProvider: (Comp) => Comp, GridLayout: ({ children }) => children, Layout: [], })) // Mock react-big-calendar vi.mock('react-big-calendar', () => ({ Calendar: ({ children }) => children, momentLocalizer.fn(), eventPropGetter.fn(), })) // Mock lottie-react vi.mock('lottie-react', () => ({ default: ({ children }) => children, })) // Mock react-helmet vi.mock('react-helmet', () => ({ Helmet: ({ children }) => children, })) export()